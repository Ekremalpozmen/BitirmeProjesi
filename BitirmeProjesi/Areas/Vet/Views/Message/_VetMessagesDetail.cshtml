<div>
    <div class="row row-cards">
        <div class="col-xl-12">
            <div class=" col-lg-12" ">
                <div class="main-content-app">
                    <div class="main-content-body main-content-body-chat h-100">
                        <div class="main-chat-body flex-2" id="ChatBody">
                            <div id="userMessages" class="content-inner">
                                @foreach (var item in ViewBag.fromUserToVetMessages)
                                {
                                    <div class="media chat-left">
                                        <div class="media-body">
                                            <div class="main-msg-wrapper">
                                                <span>@item.ContentMessage</span>
                                            </div>
                                            <div>
                                                <span>@item.CreateDate.ToString("dd-MMM-yyyy hh:mm ")</span>
                                            </div>
                                        </div>
                                    </div>
                                }
                                @foreach (var item in ViewBag.fromVetToUserMessages)
                                {
                                    <div class="media flex-row-reverse chat-right">
                                        <div class="media-body">
                                            <div id="messages" class="main-msg-wrapper">
                                                <span>@item.ContentMessage</span>
                                            </div>
                                            <div>
                                                <span>@item.CreateDate.ToString("dd-MMM-yyyy hh:mm ")</span>
                                            </div>
                                        </div>
                                    </div>
                                }
                            </div>
                        </div>
                        <div class="main-chat-footer">
                            <input id="txtMessage" class="form-control" placeholder="Mesajınızı Yazınız" type="text">
                            <button id="btnSendMessage" type="button" class="btn btn-icon  btn-primary brround"><i class="fa fa-paper-plane-o"></i></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<hr />
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-tagsinput/0.8.0/bootstrap-tagsinput.js"></script>
<script src="~/assets/plugins/p-scroll/perfect-scrollbar.js"></script>
<script src="~/assets/plugins/p-scroll/pscroll.js"></script>
<script src="~/assets/plugins/p-scroll/pscroll-1.js"></script>
<script src="~/assets/js/chat.js"></script>

<script src="~/Scripts/jquery-3.4.1.min.js"></script>
<script src="~/Scripts/jquery.signalR-2.4.3.min.js"></script>
<script src="~/SignalR/Hubs"></script>
<script>
    $(function () {
        var chat = $.connection.chatHub;
        var $message = $('#txtMessage');
        var $messages = $('#userMessages');
        function dateConverter(d) {
            const monthList = [
                "Jan",
                "Feb",
                "Mar",
                "Apr",
                "May",
                "Jun",
                "Jul",
                "Aug",
                "Sep",
                "Oct",
                "Nov",
                "Dec"
            ];

            /*Notice UTC methods are used to take care of 1st day of month and year*/
            const yr = d.getUTCFullYear();
            const mnt = monthList[d.getUTCMonth()];
            const day = d.getUTCDate() < 9 ? "0" + d.getUTCDate() : d.getUTCDate();

            const gmtHr = d.getUTCHours();
            const gmtMin =
                d.getUTCMinutes() < 9 ? "0" + d.getUTCMinutes() : d.getUTCMinutes();

            return [day, mnt, yr].join("-") + " " + [gmtHr, gmtMin].join(":");
        }
        const time = dateConverter(new Date());
        
   
        $message.focus();
        chat.client.sendMessage = function (message) {
            $messages.append('<div class="media flex-row-reverse chat-right">  <div class="media-body"><div id="messages" class="main-msg-wrapper chat-right"><span>' + message + '</span ></div><div><span>' + time + '</span ></div ></div ></div > ');
        };
        $.connection.hub.start().done(function () {
            $('#btnSendMessage').click(function () {
                chat.server.send($message.val());
                $message.val('').focus();
            });
        });
    });
</script>